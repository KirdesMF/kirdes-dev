<div
  data-lens
  class="fixed size-(--lens-radius) top-0 left-0 rounded-full z-10 border border-dashed pointer-events-none"
>
</div>
<script>
  import { gsap } from "gsap";

  function setupLens() {
    const root = document.documentElement;
    const lens = document.querySelector<HTMLDivElement>("[data-lens]");
    if (!lens) return;

    const radius = 150;
    let isHidden = true;
    root.style.setProperty("--lens-radius", `${radius}px`);

    const showLens = () => {
      if (!isHidden) return;
      isHidden = false;
      gsap.to(lens, { opacity: 1, duration: 0.25, overwrite: "auto" });
    };

    const hideLens = () => {
      if (isHidden) return;
      isHidden = true;
      gsap.to(lens, { opacity: 0, duration: 0.25, overwrite: "auto" });
    };

    const handleMouseMove = (event: MouseEvent) => {
      const mouseX = event.clientX;
      const mouseY = event.clientY;

      // CSS vars globales pour le reste du layout (parallax, mask, etc.)
      root.style.setProperty("--lens-x", `${mouseX}px`);
      root.style.setProperty("--lens-y", `${mouseY}px`);

      showLens();

      // position the circle center on the cursor
      gsap.to(lens, {
        x: mouseX - radius / 2,
        y: mouseY - radius / 2,
        duration: 0.3,
        ease: "power2.out",
        overwrite: "auto",
      });
    };

    window.addEventListener("mousemove", handleMouseMove, { passive: true });
    window.addEventListener("mouseleave", hideLens);
  }

  setupLens();
</script>
